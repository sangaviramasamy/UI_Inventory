# **Blibli Frontend Dev-tools**
> Blibli frontend developer tools

## Install :
`npm install -D @blibli/dev-tools`

<br>

## Feature :
  - Packager (Snapshot & Release)  
    Archive build result (/dist) into ZIP files
  - Dockerize (Snapshot & Release)  
    Generate Dockerfile and docker_build.properties 
  - Initialize build tools  
    Installing dependencies needed for build tools
  - Build tools (Using vite)  
    Build blibli components library (blibli dls) using vitejs
  - Build Pack Components  
    Pack components after build. Generates the metadata and packages of the components that have been built
  - Post test  
    Adjust test reports coverage file(lcov.info) and generate sonar-project.properties
  - Generate sonar  
    Generate sonar-project.properties
  - preview  
    Run mode production in local server
  - git-hooks  
    Initiate helpful git hooks for development  
    - prepare-commit-msg  
      Auto append jira code specified on branch name into commit message, so future devs understand the reason behind the changes. Example:
        1. Commiting on branch feature/GOTH-1234
        2. Doing `git commit -m "Fix button"` will result in `4b1c36774 [GOTH-1234]: Fix button`
        3. Doing `git commit` will also open a new window with this text: `[GOTH-1234]:`

<br>

## Usage :
  > Use these commands in package.json scripts :  

  - package:snapshot  
    `dev-tools package:snapshot`
  - package:release  
    `dev-tools package:release`
  - dockerize:snapshot  
    `dev-tools dockerize:snapshot`
  - dockerize:release  
    `dev-tools dockerize:release`
  - init build tools  
    `npx @blibli/dev-tools build:init`
  - build tools (Only for Blibli NPM Library)  
    `dev-tools build:run`
  - pack-components  
    `dev-tools build:pack-components`
  - post-test  
    `dev-tools post-test`
  - generate-sonar  
    `dev-tools generate-sonar`
  - preview  
    `dev-tools preview`
  - git-hooks  
    `dev-tools git-hooks`

<br>

## Commands :
### **Standalone, ui-main, collab projects** :
    "package-snapshot": "npm run build && dev-tools package:snapshot && dev-tools dockerize:snapshot", //Generate target folder containing zip snapshot package and Generate Dockerfile and docker_build.properties
    "package-release": "npm run build && dev-tools package:release && dev-tools dockerize:release", //Generate target folder containing zip release package and Generate Dockerfile and docker_build.properties
    "posttest": "dev-tools post-test" //Adjust coverage file and generate sonar-project.properties 
    "posttest": "dev-tools generate-sonar" //Generate sonar-project.properties 
    "http": "dev-tools preview" //Run mode production in local

### **Blibli Components Module(Library)** :
  > Initialize build tools using commands :  
  > `npx @blibli/dev-tools build:init`

    "build": "dev-tools build:run" //Build components using vite build
    "pack-components": "dev-tools build:pack-components" //Pack-components after build components

<br>

## Parameters Information :
### **Packager** :
| Name                                | Description                                                                               | Default Value                | Example                                                            |
|-------------------------------------|-------------------------------------------------------------------------------------------|------------------------------|--------------------------------------------------------------------|
| packager.groupId*                   | groupId                                                                                   | `'com.gdn.app-ui'`           | `'com.gdn.digital.product'`                                        |
| packager.isCollab                   | Define whether the project is a collab or not                                             | `false`                      | `true`          
| packager.distDir                    | Custom name for dist folder in project                                                    | `'dist'`                     | `'dist-docs'`                                                      |
| packager.includes.files             | Files in the dist folder to be archived                                                   | `['index.html']`             | `['index.html', 'manifest.json']`                                  |
| packager.includes.dirs              | Directory in the dist folder to be archived                                               | `['static']`                 | `['launcher', 'sw']`                                               |
| packager.cleanUps                   | Files and directory to be cleaned up(deleted) locally after archive                       | `[]`                         | `['default']`                                                      |
| packager.adaptiveTargets            | List of source and target folder for build                                                | `[{source:'',target:''}]`    | `[{source:'default',target:'default'}]`                            |
| packager.adaptiveTargets[0].source  | Name of directory that contains the dist folder                                           | `''`                         | `'default'`                                                        |
| packager.adaptiveTargets[0].target  | Name of directory as target copy from dist folder                                         | `''`                         | `'default'`                                                        |  

\* is required parameter  
*default value will be replaced with the value you added through the blibli-dev-tools.config.js*

<br>

### **Dockerize** :
| Name                                | Description                                                                               | Default Value                | Example                                                            |
|-------------------------------------|-------------------------------------------------------------------------------------------|------------------------------|--------------------------------------------------------------------|
| dockerize.serviceName               | service-name for docker_build.properties                                                  | `packageJson.name`           | `'ui-digital'`                                                     |
| dockerize.rootDir                   | Root directory for Dockerfile                                                             | `'app'`                      | `'digital-ui'`                                                     |
| dockerize.staticDir                 | Static directory for Dockerfile                                                           | `''`                         | `'digital-product'`                                                |

*default value will be replaced with the value you added through the blibli-dev-tools.config.js*

<br>

### **Build tools (Vite)** :
| Name                               | Description                                                                               | Default Value                                                                         | Example                                                            |
|------------------------------------|-------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------|--------------------------------------------------------------------|
| build.vue                          | Vue version for build [ 2 \| 3 ]                                                                                   | `3`                          | `2`                                                                | 
| build.formats                      | Formats for build [ 'es' \| 'cjs' ]                                                                               | `['es','cjs']`               | `['es']`                                                           |
| build.sourceComponents<sup>*</sup> | Source of the component to be built [ 'src/...' \| 'components-map.json' ]                                                               | `'src/index.js'`             | `'src/icons'`                                                      |
| build.externals                    | externals library, not to be included in components build                                 | `{ 'vue': 'Vue', 'pinia': 'pinia', 'vue-router': 'VueRouter', 'vue-i18n': 'VueI18n'}` | `{ 'vue': 'Vue', 'vue-router': 'VueRouter' }`                       |

* is required parameter 

<sup>*</sup> default value will be replaced with the value you added through the blibli-dev-tools.config.js*

<br>

### **Sonar** :
| Name                                | Description                                                                               | Default Value                     | Example                                                            |
|-------------------------------------|-------------------------------------------------------------------------------------------|------------------------------|--------------------------------------------------------------------|
| sonar.projectKey*                   | The project's unique key for sonar-project.properties                                     | `packager.groupId:packageJson.name`    | `'com.gdn.pyeongyang-ui:main'`                                                           |
| sonar.lcovAdjustPaths               | List of coverage file(lcov.info) paths to be adjusted                                     | `['tests/coverage/lcov.info']`         | `['tests/unit/coverage/lcov.info']`                                                      |
| sonar.sources                       | List of paths to directories containing main source files                                 | `['.']`                           | `['.']`                                                      |
| sonar.tests                         | List of paths to directories containing test source files                                 | `['tests']`                    | `['tests']`                                                      |
| sonar.exclusions                    | List of file path patterns to be excluded from sonar analysis.                            | Default values can be seen in additional information(sonar.exclusions)           | `['node_modules/**','target/**','build/**',...]`                                         |
| sonar.lcovReportPaths               | List of lcov report paths to be imported                                                  | `['tests/coverage/lcov.info']`          | `['tests/coverage/lcov.info','integrations/coverage/lcov.info']`                                    |

\* is required parameter  
*default value will be replaced with the value you added through the blibli-dev-tools.config.js (except sonar.exclusions)*

<br>

### **Preview** :
| Name                                | Description                                                                               | Default Value                | Example                                                            |
|-------------------------------------|-------------------------------------------------------------------------------------------|------------------------------|--------------------------------------------------------------------|
| preview.port                        | Port for local server                                                                     | `10001`                      | `10028`                                                        | 
| preview.publicPath                  | Public Path for resources folder in collab project(Only used in collab project)           | `''`                         | `'product-detail'`                                             |
| preview.proxy                       | Object of proxyTable used by project                                                      | `{}`                            | `proxyTable`                                                   |
| preview.replaceVars                 | Object of Variables to be replaced in production mode                                     | `{_STATIC_PUBLIC_PATH: '/'}`  | `{_STATIC_PUBLIC_PATH: '/',_BLIBLI_COLLAB_VER: '1.0.0'}`       |
| preview.noHTMLResponseUrl           | List of path/url that are not responding html file(Only data)                             | `['/static/','/backend/']`                  | `['/static/','/backend/','/product/static/']`                    |

*default value will be replaced with the value you added through the blibli-dev-tools.config.js*

<br>

## Additional information :
| Name                       | Description                                                                                                                                        | 
|----------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------|
| packager                   | Config for packager feature                                                                                                 | 
| packager.adaptiveTarget    | Array of object that contains source location of dist folder(default is root) of and target location of files and folders when archived                                                                                           | 
| dockerize                  | Config for dockerize feature                              
| build                      | Config for build tool using vite                                                                                                    | 
| build.sourceComponents     | Location of the components to be build. Can be filled between 'components-map.json' or path in src ('src/.../...'). By default will build 'src/index.js'                                                                       | 
| sonar                      | Config for sonar-project.properties and lcov.info file adjustment                                                                       | 
| sonar.projectKey           | The project's unique key. By default: `packager.groupId:packageJson.name`. Example: `'com.gdn.digital.ui:pyeongyang-ui-digital'`                                                                       | 
| sonar.exclusions           | Default value: `['node_modules/**','target/**','build/**','config/**','tests/**','test/**','dist/**','src/api-mock/**','src/assets/**','src/main.js','src/init.js','src/i18n/**','src/data/**','vue.config.js','babel.config.js','integrations/**','blibli-integration-test.config.js','blibli-dev-tools.config.js'adjustment]`.  <br> The value you entered in sonar.exclusions will be added to the default value (Not replaced)      | 

<br>

> source : http://npm-registry.gdn-app.com/#/detail/@blibli/dev-tools  
> repository : https://stash.gdn-app.com/projects/BLIBLIJSLIB/repos/blibli-dev-tools/

<br>

# Blibli Dev-tools Changelog
## [0.4.10] - 2023-03-28
### Added
* Add compatibility to archive build assets without version folder for collab project
  
## [0.4.9] - 2023-03-08
### Updated
* Sanitized unsafe path chars for package name
  
## [0.4.8] - 2023-03-06
### Added
* Add custom dist folder in packager
* Add custom dist folder in preview
   
## [0.4.7] - 2023-02-02
### Added
* Added feature to run production mode in local server (dev-tools preview)
* Modify config file
  
## [0.4.6] - 2023-01-31
### Updated
* Sanitize filenames from package_name
* adding arbitrary change to trigger jenkins branch detection
  
## [0.4.4] - 2023-01-05
### Updated
* Update readme to fix structure and naming
* Add default value sonar.lcovReportPaths 
  
## [0.4.3] - 2023-01-03
### Added
* Added feature build:init to set up and install dependencies needed for build blibli library modules
* Use dev-tools build:init or npx @blibli/dev-tools build:init to initialize build library modules

## [0.4.2] - 2022-12-05
### Added
* Added resolve alias '~' and '@' to node_modules and src in vite config
### Changed
* Change command 'dev-tools build' to 'dev-tools build:run'
* Change command 'dev-tools pack-components' to 'dev-tools build:pack-components'
  
## [0.4.1] - 2022-11-14
### Added
* Added feature pack-components to generates the metadata and packages of the components that have been built
  
## [0.3.3] - 2022-09-16
### Updated
* Update packager to run synchronously
* Change validation on blibli-dev-tools config file and fix default values in readme
  
## [0.3.2] - 2022-07-29
### Updated
* Change default value on blibli-dev-tools sonar.test and configuration when run dockerize
  
## [0.3.1] - 2022-07-29
### Updated
* Bug fixing on yargs and replace dependency change-case with param-case
  
## [0.3.0] - 2022-07-27
### Updated
* Update packager feature: Updated configuration for project collab that will only archive resource
  
## [0.2.0] - 2022-07-18
### Added
* Add Feature: post-test to generate Sonar-project.properties and adjust coverage file
  
## [0.1.0] - 2022-06-30
### Added
* Add Feature: Build tools using vite
  
## [0.0.6] - 2022-06-16
### Changed
* Change parameter and add default value for packager on blibli-dev-tools.config.js
* Handle error and give warning when archive failed

## [0.0.5] - 2022-05-09
### Added
* Add cli-validator 
### Changed
* Change structure files and folders

## [0.0.4] - 2022-04-21
### Changed
* Change on Dockerfile.default

## [0.0.3] - 2022-04-18
### Changed
* Change parameter names in blibli-dev-tools.config.js
* Change readme and package.json

## [0.0.2] - 2022-04-14
### Added
* Add Feature: packager and dockerize 

## [0.0.1] - 2022-04-01
### Initiation
